# Пакетная установка туннелера для РЕД ОС

{% hint style="warning" %}
Статья написана для РЕД ОС версии 7.3.4 с отключенной системой контроля доступа SELinux.
{% endhint %}

## Подготовка системы

Предварительно необходимо обновить пакеты в системе:

```
sudo yum upgrade
```

Отключить SELinux:

```
sudo sed -i 's/^SELINUX=.*/SELINUX=disabled/g' /etc/selinux/config
sudo setenforce 0
```

## Установка rpm пакета <a href="#user-content-ustanovka-rpm-paketa" id="user-content-ustanovka-rpm-paketa"></a>

Скачать и разархивировать пакет из личного кабинета:

```
tar -xvf ./hostvm-gw<номер версии>-<номер сборки>.rpm.tar.bz2
```

\
Установить пакет:

```
sudo yum install ./hostvm-gw-3.6-3.el7.x86_64.rpm
```

Для версии 3.6-3 и свежее шаг запуска postinst.sh не выполняется:\
Запустить скрипт для установки необходимых зависимостей и настройки системы:

```
sudo /usr/share/hostvm/setup/postinst.sh
```

В ходе работы скрипта postinst.sh появится уведомление о приглашении к вводу версии java, которая будет использована. Необходимо указать java-11.

После завершения работы скрипта для успешной установки https-соединения между туннелером и брокером, необходимо скачать сертификат брокера на сервер туннеллера.  Сохранить сертификат в директорию:

```
/etc/pki/ca-trust/source/anchors/
```

После экспорта применить команду:

```
sudo update-ca-trust
```

И добавить запись в /etc/hosts:

```
xxx.xxx.xxx.xxx hostvm-vdi36
```

Для установки и настройки HOSTVM VDI Tunneler запустить команду:

```
sudo hostvm-setup
```

В процессе установки выбрать тип подключения https и следовать дальнейшим инструкциям установочного скрипта.
