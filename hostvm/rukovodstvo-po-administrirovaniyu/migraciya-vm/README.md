# Миграция ВМ

Живая миграция - процесс перемещения включенной ВМ с одного хоста на другой. Менеджер виртуализации перемещает память, подключения к хранилищу и сетям ВМ с исходного хоста на конечный. Живая миграция помогает выполнять задачи по обслуживанию хостов без прерывания работы ВМ. Живая миграция прозрачна для конечного пользователя. В процессе живой миграции машины она остается включенной и приложения внутри нее продолжают работать. Клиенты, взаимодействующие с ВМ, могут столкнуться только с небольшой сетевой задержкой в несколько миллисекунд при окончании процесса перемещения машины. Для корректной работы живой миграции архитектура и поддерживаемые инструкции CPU конечного хоста должны совпадать с исходным. Для обеспечения соблюдения этого условия платформа HOSTVM позволяет собирать хосты в кластеры. Миграция ВМ может быть выполнена только между хостами одного кластера. Это позволяет не допустить миграции ВМ между хостами, поддерживающими разный набор инструкций процессора. Администраторы должны убедиться, что система HOSTVM имеет конфигурацию, поддерживающую функционал живой миграции, прежде чем использовать его. Живая миграция ВМ имеет следующие требования к конфигурации системы:

* миграция ВМ может быть выполнена только на хост, принадлежащий тому же кластеру, в котором запущена машина. Оба хоста должны иметь статус Up;
* оба хоста должны иметь доступ к одному и тому же набору виртуальных сетей, VLAN, и хранилищ (доменов данных);
* целевой хост должен иметь достаточное количество свободных ресурсов CPU и RAM в соответствии с требованиями ВМ;
* на вкладке Custom properties конфигурации ВМ не должно быть выставлено значение параметра cache, отличное от значения по умолчанию (none). Для обеспечения целостности данных при миграции, кэш ВМ должен быть отключен (по умолчанию).

Живая миграция использует для передачи данных соответствующую сеть migration network. В конфигурации по умолчанию логическая сеть ovirtmgmt используется и как управляющая (management), и как сеть для миграции (migration). Хотя живая миграция и имеет возможность ограничения по максимальной скорости передачи данных и количеству одновременных миграций, но при интенсивном использовании ее трафик может загружать канал и, соответственно, влиять на управляющий трафик при использовании одной сети. Для наилучшей производительности рекомендуется разделять сети для трафика хранилища, живой миграции и управляющего.
